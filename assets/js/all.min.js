var h=function(){var f=[];return{j:function(c,b){var a=c.querySelector("span.items-count");if(a){var e=c.getAttribute("data-feed-id"),l=c.querySelector("h2:first-of-type");l.className="loading-icon";var f=new XMLHttpRequest;f.onload=function(){l.className="";c.removeAttribute("data-feed-error");var e=c.querySelector(".feed-last-checked");e&&(e.innerHTML=e.getAttribute("data-after-update"));e=JSON.parse(this.responseText);e.result?a.innerHTML=e.items_count.items_unread+"/"+e.items_count.items_total:
c.setAttribute("data-feed-error","1");b?b(e):g.a()};f.open("POST","?action=refresh-feed&feed_id="+e,!0);f.send()}},l:function(){var c=Array.prototype.slice.call(document.querySelectorAll("article:not([data-feed-disabled])")),b=setInterval(function(){for(;0<c.length&&5>f.length;){var a=c.shift();f.push(parseInt(a.getAttribute("data-feed-id"),10));h.j(a,function(a){a=f.indexOf(a.feed_id);0<=a&&f.splice(a,1);0===c.length&&0===f.length&&(clearInterval(b),g.a())})}},100)}}}(),g=function(){function f(d){var a=
document.createEvent("MouseEvents");a.initEvent("mousedown",!0,!0);d.dispatchEvent(a);a=document.createEvent("MouseEvents");a.initEvent("mouseup",!0,!0);d.dispatchEvent(a);d.click()}function c(d){return item_id=d.getAttribute("data-item-id")}function b(d){if(d&&d.hasAttribute("data-reverse-label")){var a=d.innerHTML;d.innerHTML=d.getAttribute("data-reverse-label");d.setAttribute("data-reverse-label",a)}}function a(d){if("read"!==d.getAttribute("data-item-status")){if(d.getAttribute("data-hide"))e(d);
else{d.setAttribute("data-item-status","read");var a=d.querySelector("a.mark");b(a);(d=d.querySelector("a.mark"))&&d.setAttribute("data-action","mark-unread")}m--}}function e(d){"mouse"!==n.c&&r.f();d.parentNode.removeChild(d);p--}function l(){-1<window.location.href.indexOf("nothing_to_read=1")&&0<m?window.location.href="?action=unread":0===p&&window.location.reload();var d=document.getElementById("page-counter");d&&(d.textContent=p||"");document.getElementById("nav-counter").textContent=m||"";var a=
document.querySelector("div.page-header h2:first-of-type");if(a)pageHeading=a.firstChild.nodeValue;else if(a=document.querySelector("article.item h1:first-of-type")){document.title=a.textContent;return}switch(document.querySelector("section.page").getAttribute("data-item-page")){case "unread":document.title="Miniflux ("+m+")";break;case "feed-items":document.title="("+p+") "+pageHeading;break;default:document.title=d?pageHeading+" ("+p+")":pageHeading}}function u(d){var b=c(d),e=new XMLHttpRequest;
e.onload=function(){r.b()&&(a(d),l())};e.open("POST","?action=mark-item-read&id="+b,!0);e.send()}function w(d){var a=c(d),k=new XMLHttpRequest;k.onload=function(){if(r.b()){if("unread"!==d.getAttribute("data-item-status")){if(d.getAttribute("data-hide"))e(d);else{d.setAttribute("data-item-status","unread");var a=d.querySelector("a.mark");b(a);(a=d.querySelector("a.mark"))&&a.setAttribute("data-action","mark-read")}m++}l()}};k.open("POST","?action=mark-item-unread&id="+a,!0);k.send()}var t=[],q=!1,
m=function(){var a=document.getElementById("nav-counter");if(a)return counter=parseInt(a.textContent,10)||0}(),p=function(){var a=document.getElementById("page-counter");if(a)return counter=parseInt(a.textContent,10)||0}();return{w:u,B:w,A:function(a){var b=c(a),k=new XMLHttpRequest;k.onload=function(){r.b()&&(e(a),"unread"===a.getAttribute("data-item-status")&&m--,l())};k.open("POST","?action=mark-item-removed&id="+b,!0);k.send()},i:function(a){var f=c(a),k="1"===a.getAttribute("data-item-bookmark")?
"0":"1",v=new XMLHttpRequest;v.onload=function(){var c=document.querySelector("section.page");if(r.b()&&"bookmarks"===c.getAttribute("data-item-page"))e(a),l();else if(a.setAttribute("data-item-bookmark",k),r.b())c=a.querySelector("a.bookmark"),b(c);else if((c=a.querySelector("a.bookmark-icon"))&&c.hasAttribute("data-reverse-title")){var f=c.getAttribute("title");c.setAttribute("title",c.getAttribute("data-reverse-title"));c.setAttribute("data-reverse-title",f)}};v.open("POST","?action=bookmark&id="+
f+"&value="+k,!0);v.send()},L:function(a){var b=a.getAttribute("data-item-status");"read"===b?w(a):"unread"===b&&u(a)},J:function(a){(a=a.querySelector("a.show"))&&f(a)},F:function(a){(a=a.querySelector("a.original"))&&f(a)},g:function(a){var b=document.getElementById("download-item");if(b){b.innerHTML=" "+b.getAttribute("data-before-message");b.className="loading-icon";var e=new XMLHttpRequest;e.onload=function(){var a=JSON.parse(e.responseText);b.className="";if(a.result){var d=document.getElementById("item-content");
d&&(d.innerHTML=a.content);b.innerHTML=b.getAttribute("data-after-message")}else b.innerHTML=b.getAttribute("data-failure-message")};a=c(a);e.open("POST","?action=download-item&id="+a,!0);e.send()}},C:function(b){var c=new XMLHttpRequest;c.onload=function(){for(var b=document.getElementsByTagName("article"),d=0,c=b.length;d<c;d++)a(b[d]);m=this.responseText;l()};c.open("POST","?action=mark-feed-as-read&feed_id="+b,!0);c.send()},M:function(){for(var a=["#current-item h1","#item-content","#listing #current-item h2",
"#listing #current-item .preview"],b=0;b<a.length;b++){var c=document.querySelector(a[b]);c&&(c.dir=""==c.dir?"rtl":"")}},N:function(){return q},a:function(){if(!document.hidden||!q){var a=new XMLHttpRequest;a.onload=function(){var a=0===t.length,b=!1,c=JSON.parse(this.responseText),d;for(d in c.feeds){var e=c.feeds[d];if(!t.hasOwnProperty(d)||e.time>t[d])t[d]=e.time,"unread"===e.status&&(b=!0)}document.hidden||c.nbUnread===m&&!q?document.hidden&&!a&&b&&(q=!0,document.title="\u21bb "+document.title):
(q=!1,m=c.nbUnread,l())};a.open("POST","?action=latest-feeds-items",!0);a.send()}},I:function(){var a=document.getElementsByTagName("article");for(i=0;i<a.length;i++)0>a[i].getBoundingClientRect().top&&u(a[i])}}}(),n=function(){function f(a){if(63!==a.keyCode&&63!==a.which&&(a.ctrlKey||a.shiftKey||a.altKey||a.metaKey))return!0;a=a.target||a.srcElement;return"INPUT"===a.tagName||"TEXTAREA"===a.tagName?!0:!1}var c=[],b=null;return{c:"",s:function(){document.onclick=function(a){a.target.hasAttribute("data-action")&&
"original"!==a.target.className&&a.preventDefault()};document.onmouseup=function(a){if(2!==a.button)if("INPUT"===a.target.nodeName&&"auto-select"===a.target.className)a.target.select();else{var b=a.target.getAttribute("data-action");if(b){n.c="mouse";var c;a:{for(element=a.target;element&&element.parentNode;)if(element=element.parentNode,element.tagName&&"article"===element.tagName.toLowerCase()){c=element;break a}c=void 0}switch(b){case "refresh-all":h.l();break;case "refresh-feed":c&&h.j(c);break;
case "mark-read":c&&g.w(c);break;case "mark-unread":c&&g.B(c);break;case "mark-removed":c&&g.A(c);break;case "bookmark":c&&g.i(c);break;case "download-item":c&&g.g(c);break;case "mark-feed-read":g.C(a.target.getAttribute("data-feed-id"))}}}}},o:function(){document.onkeypress=function(a){if(!f(a))if(n.c="keyboard",c.push(a.key||a.which),"g"===c[0]||103===c[0])switch(c[1]){case void 0:break;case "u":case 117:window.location.href="?action=unread";c=[];break;case "b":case 98:window.location.href="?action=bookmarks";
c=[];break;case "h":case 104:window.location.href="?action=history";c=[];break;case "s":case 115:window.location.href="?action=feeds";c=[];break;case "p":case 112:window.location.href="?action=config";c=[];break;default:c=[]}else{c=[];var b=document.getElementById("current-item");switch(a.key||a.which){case "d":case 100:b&&g.g(b);break;case "p":case 112:case "k":case 107:r.h();break;case "n":case 110:case "j":case 106:r.f();break;case "v":case 118:b&&g.F(b);break;case "o":case 111:b&&g.J(b);break;
case "m":case 109:b&&g.L(b);break;case "f":case 102:b&&g.i(b);break;case "h":case 104:r.G();break;case "l":case 108:r.D();break;case "r":case 114:h.l();break;case "?":case 63:r.K();break;case "z":case 122:g.M()}}};document.onkeydown=function(a){if(!f(a))switch(n.c="keyboard",a.key||a.which){case "ArrowLeft":case "Left":case 37:r.h();break;case "ArrowRight":case "Right":case 39:r.f()}}},v:function(){document.addEventListener("visibilitychange",function(){!document.hidden&&g.N()&&g.a()})},u:function(){document.addEventListener("scroll",
function(){null!==b&&(clearTimeout(b),b=null);b=setTimeout(function(){g.I()},2E3)})}}}(),r=function(){function f(b){var a=pageYOffset+document.documentElement.clientHeight;(0>a-(b.offsetTop+b.offsetHeight)||a-b.offsetTop>document.documentElement.clientHeight)&&window.scrollTo(0,b.offsetTop-10)}function c(){return document.getElementById("listing")?!0:!1}return{D:function(){var b=document.getElementById("next-page");b&&b.click()},G:function(){var b=document.getElementById("previous-page");b&&b.click()},
f:function(){var b=document.getElementById("next-item");if(b)b.click();else if(c())if(b=document.getElementsByTagName("article"),document.getElementById("current-item"))for(var a=0,e=b.length;a<e;a++){if("current-item"===b[a].id){a+1<e&&(b[a].id="item-"+b[a].getAttribute("data-item-id"),b[a+1].id="current-item",f(b[a+1]));break}}else b[0].id="current-item",f(b[0])},h:function(){var b=document.getElementById("previous-item");if(b)b.click();else if(c())if(b=document.getElementsByTagName("article"),
document.getElementById("current-item"))for(var a=b.length-1;0<=a;a--){if("current-item"===b[a].id){0<=a-1&&(b[a].id="item-"+b[a].getAttribute("data-item-id"),b[a-1].id="current-item",f(b[a-1]));break}}else b[b.length-1].id="current-item",f(b[b.length-1])},K:function(){open("?action=show-help","Help","width=320,height=450,location=no,scrollbars=no,status=no,toolbar=no")},b:c}}();
({O:function(){},H:function(){n.o();n.s();n.v();this.m()},m:function(){var f=new XMLHttpRequest;f.onload=function(){var c=JSON.parse(this.responseText);0<c.frontend_updatecheck_interval&&(g.a(),setInterval(function(){g.a()},6E4*c.frontend_updatecheck_interval));"1"===c.scroll_marks_read&&n.u()};f.open("POST","?action=get-config",!0);f.send(JSON.stringify(["frontend_updatecheck_interval","scroll_marks_read"]))}}).H();